{
    "type": "Ext.form.Panel",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "cls": [
            "EMAType"
        ],
        "designer|userClassName": "EMAType5",
        "scrollable": "vertical"
    },
    "designerId": "0fbc87db-4927-439d-bca2-70278fc51350",
    "cn": [
        {
            "type": "Ext.form.FieldSet",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "goola": "ema",
                "itemId": "fset",
                "instructions": null,
                "title": null
            },
            "designerId": "19b9c1da-91dd-4258-abf8-a7343b400add",
            "customConfigs": [
                {
                    "group": "(Custom Properties)",
                    "name": "goola",
                    "type": "string"
                }
            ],
            "cn": [
                {
                    "type": "Ext.field.Slider",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "itemId": "experience",
                        "label": "What is your experience in this moment? <br/>  <div><span style=\"float:right\">overwhelmed</span><span>balanced</span></div>",
                        "labelAlign": "top",
                        "labelWrap": true,
                        "name": "experience",
                        "value": [
                            50
                        ]
                    },
                    "designerId": "63b49fc8-38c4-415f-9be0-d0da010378b3"
                },
                {
                    "type": "Ext.Button",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "action": "exercise",
                        "disabled": null,
                        "itemId": "done",
                        "text": "Done"
                    },
                    "designerId": "cb90b7b0-8cb9-406e-b4f7-37748cc7fa34",
                    "customConfigs": [
                        {
                            "group": "(Custom Properties)",
                            "name": "action",
                            "type": "string"
                        }
                    ],
                    "cn": [
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onDoneRelease",
                                "implHandler": [
                                    "experience=button.parent.child('#stress').getValue();",
                                    "",
                                    "user = HEART.getItem('local', 'user');",
                                    "user = JSON.parse(user);",
                                    "",
                                    "user.experience=experience;",
                                    "",
                                    "user = JSON.stringify(user);",
                                    "HEART.setItem('local', 'user', user);",
                                    "",
                                    "if(this.goola=='followup'){return;}",
                                    "",
                                    "",
                                    "if(experience>50){",
                                    "",
                                    "\tEMX = ['EMITensionCheck', 'EMIGeneralMindfulness', 'EMIAudio4', 'EMIAudio7'];",
                                    "",
                                    "\ttype = EMX[Math.floor(EMX.length*Math.random())]; ",
                                    "",
                                    "\tform = Ext.create('HEART.view.'+type);",
                                    "",
                                    "\tExt.Viewport.getActiveItem().setActiveItem(2);",
                                    "\tExt.Viewport.getActiveItem().getActiveItem().push(form);",
                                    "",
                                    "\tif(Math.random()<1/3){",
                                    "",
                                    "\t\tsetTimeout(function(){",
                                    "",
                                    "\t\t\tform = Ext.create('HEART.view.'+this.emxType);",
                                    "\t\t\tform.goola = 'followup';",
                                    "",
                                    "\t\t\tExt.Viewport.getActiveItem().setActiveItem(2);",
                                    "\t\t\tExt.Viewport.getActiveItem().getActiveItem().push(form);",
                                    "",
                                    "\t\t}, 1000*60*15);",
                                    "",
                                    "\t\tsetTimeout(function(){",
                                    "",
                                    "\t\t\tuser = HEART.getItem('local', 'user');",
                                    "\t\t\tuser = JSON.parse(user);",
                                    "",
                                    "\t\t\tif(user.experience>50){",
                                    "",
                                    "\t\t\t\tform = Ext.create('HEART.view.'+this.emxType);",
                                    "\t\t\t\tform.goola = 'followup';",
                                    "",
                                    "\t\t\t\tExt.Viewport.getActiveItem().setActiveItem(2);",
                                    "\t\t\t\tExt.Viewport.getActiveItem().getActiveItem().push(form);",
                                    "\t\t\t}",
                                    "",
                                    "",
                                    "\t\t}, 1000*60*30);",
                                    "",
                                    "\t}\t",
                                    "",
                                    "}",
                                    "",
                                    "",
                                    "mylog = JSON.parse(HEART.getItem('local', 'mylog'))||{};",
                                    "",
                                    "dead = new Date(Date.now()-Date.now()%(1000*60*60*24*7)+(1000*60*60*24*10));",
                                    "",
                                    "if(mylog.expire){",
                                    "\tif(Date.now()>mylog.expire){",
                                    "\t\tmylog = {};",
                                    "\t\tmylog.expire = dead;",
                                    "\t}",
                                    "",
                                    "}else{",
                                    "\tmylog.expire = dead",
                                    "}",
                                    "",
                                    "balance = mylog.balance||{ average: experience, count: 0 };",
                                    "",
                                    "balance.average=(balance.average*balance.count+experience)/(balance.count+1);",
                                    "",
                                    "balance.count+=1;",
                                    "",
                                    "mylog.balance=balance;",
                                    "",
                                    "mylog = JSON.stringify(mylog);",
                                    "HEART.setItem('local', 'mylog', mylog);",
                                    "",
                                    "button.fireEvent('tap');"
                                ],
                                "name": "release"
                            },
                            "designerId": "4fca3a3e-dd20-482c-a72b-41a3f3c7c615"
                        }
                    ]
                }
            ]
        }
    ]
}